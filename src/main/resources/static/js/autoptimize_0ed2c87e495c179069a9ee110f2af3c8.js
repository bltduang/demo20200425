/*!cherry v1.0.0 | (c) 2019 Overbool |*/"use strict";function grin(t){var e;if(t=" "+t+" ",!document.getElementById("comment")||"textarea"!=document.getElementById("comment").type)return!1;if(e=document.getElementById("comment"),document.selection)e.focus(),sel=document.selection.createRange(),sel.text=t,e.focus();else if(e.selectionStart||"0"==e.selectionStart){var o=e.selectionStart,r=e.selectionEnd,n=r;e.value=e.value.substring(0,o)+t+e.value.substring(r,e.value.length),n+=t.length,e.focus(),e.selectionStart=n,e.selectionEnd=n}else e.value+=t,e.focus()}$(function(){$(document).on("click",".btn-login",function(){$(".login-wrap").iziModal("open"),$(".tab-nav").tab()}),$(document).on("submit",".form-login",function(t){t.preventDefault(),$(".form-login-submit").text(cherryAjax.loadingMsg),$.ajax({type:"POST",dataType:"json",url:cherryAjax.ajaxUrl,data:$(".form-login").serialize()+"&action=ajaxLogin",success:function(t){t.code?($(".login-wrap").iziModal("close"),$.toast({text:"登陆成功，正在跳转...",icon:"success",position:"top-center",hideAfter:1e3}),document.location.reload()):$.toast({text:t.msg,icon:"error",position:"top-center",hideAfter:1e3})},error:function(t){console.log("error: ",t),t.msg?$.toast({text:t.msg,icon:"error",position:"top-center",hideAfter:1e3}):$.toast({text:"错误的请求",icon:"error",position:"top-center",hideAfter:1e3})}})}),$(document).on("submit",".form-register",function(t){t.preventDefault(),$(".form-register-submit").text(cherryAjax.loadingMsg),$.ajax({type:"POST",dataType:"json",url:cherryAjax.ajaxUrl,data:$(".form-register").serialize()+"&action=ajaxRegister",success:function(t){t.code?document.location.href=cherryAjax.homeUrl:(console.log("error: ",t),$.toast({text:t.msg,icon:"error",position:"top-center",hideAfter:1e4}))},error:function(t){t.msg?$.toast({text:t.msg,icon:"error",position:"bottom-center",hideAfter:1e4}):(console.log("error: ",t),$.toast({text:"错误的请求",icon:"error",position:"top-center",hideAfter:1e4}))}})})}),$(function(){var r=!1,n=$(".submit-title");$(document).on("submit",".form-submit",function(t){t.preventDefault();var e=$(this);$.ajax({type:"POST",dataType:"json",url:cherryAjax.ajaxUrl,data:$(this).serialize()+"&action=postContent",success:function(t){t.code?($.toast({text:t.msg,icon:"success",position:"bottom-right"}),e[0].reset(),localStorage.removeItem("postTitle"),localStorage.removeItem("postContent")):$.toast({text:t.msg,icon:"error",position:"bottom-right"})},error:function(t){$.toast({text:t,icon:"error",position:"bottom-right"})}}),console.log($(this).serialize())}),$(window).on("load",function(){var t=$("#submit-content_ifr"),e=localStorage.getItem("postContent"),o=localStorage.getItem("postTitle");e&&(t.contents().find(".mce-content-body").html(e),n.val(o)),t.contents().find(".mce-content-body").on("keyup",function(){var t=$(this);r||(r=!0,setTimeout(function(){localStorage.setItem("postContent",t.html()),localStorage.setItem("postTitle",n.val()),$.toast({text:"已经保存为草稿",position:"bottom-right",stack:!1,hideAfter:300}),r=!1},2e3))})}),$(".form-update-user").on("submit",function(t){t.preventDefault(),$.ajax({type:"POST",dataType:"json",url:cherryAjax.ajaxUrl,data:{action:"updateUser",id:$(".form-update-user .user-id").val(),nickname:$(".form-update-user .nickname").val(),email:$(".form-update-user .email").val(),homepage:$(".form-update-user .homepage").val(),description:$(".form-update-user .description").val()},success:function(t){t.code?$.toast({text:t.msg,icon:"success",position:"up-right"}):$.toast({text:t.msg,icon:"error",position:"up-right"})},error:function(t){$.toast({text:t,icon:"error",position:"up-right"})}})}),$(document).on("submit",".form-avatar",function(t){t.preventDefault();var e=new FormData;e.append("avatar",$(".form-avatar .avatar")[0].files[0]),e.append("action","updateAvatar"),$.ajax({type:"POST",cache:!1,url:cherryAjax.ajaxUrl,data:e,processData:!1,contentType:!1,success:function(t){var e=JSON.parse(t);e.code?($.toast({text:"头像更新成功",icon:"success",position:"top-center",hideAfter:1e3}),$(".user-avatar img").attr("src",e.extra),$(".header-avatar").attr("src",e.extra),$(".user-avatar-cover").attr("style","background-image: url(".concat(e.extra,");"))):$.toast({text:e.msg,icon:"error",position:"top-right",hideAfter:1e3})},error:function(t){$.toast({text:t.msg,icon:"error",position:"up-right"})}})})}),$(function(){$(document).on("click",".btn-upload-thumbnail",function(){var e;e||(e=wp.media({title:"选择图片",button:{text:"添加为封面图"},multiple:!1})).on("select",function(){var t=e.state().get("selection").first().toJSON();"png"===t.subtype||"jpeg"===t.subtype||"gif"===t.subtype?($(".thumbnail-img").attr("src",t.url).removeClass("d-none"),$("input.thumbnail").val(t.id)):alert("请选择图片！")}),e.open()})});var wpieAjaxRequest=function(t,e,o,r){$.ajax({type:e,url:t,data:o,dataType:"json",success:function(t){r(t)},error:function(t){console.log("error: ",t)}})};/*!nav v1.0.0 | (c) 2019 overbool |*/(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";$(document).on("click",".menu-collapse .menu-header",function(e){$(this).toggleClass("active"),$(this).parent().find(".menu-list").toggleClass("active")}),$(document).on("click",".menu-item",function(e){$(".sidenav .menu-item").removeClass("active"),$(this).addClass("active")}),new SmoothScroll('a[href*="#"]',{speedAsDuration:!0,speed:600,offset:24}),$(document).on("click",".navbar-burger",function(e){$(this).toggleClass("active"),$(".sidenav").toggleClass("active")}),$(document).on("click",".add-navigation",function(e){e.preventDefault(),$(this).css("display","none"),$(".navigation-submit").css("display","block"),$(".form-control-site-name").focus()}),$(document).on("click",".navigation-submit-close",function(e){e.preventDefault(),$(this).parent().parent().css("display","none"),$(".add-navigation").css("display","flex")}),$(document).on("submit",".navigation-submit",function(e){e.preventDefault();var t=$(this).serialize()+"&action=ajaxSubmitNavigation";$(this).trigger("reset"),wpieAjaxRequest(wpieAjax.ajaxUrl,"POST",t,function(e){var t=$.parseHTML(e.msg);$(t).insertBefore(".add-navigation-wrap"),$(".navigation-submit").css("display","none"),$(".add-navigation").css("display","flex")})}),$(document).on("click",".card-delete",function(e){e.preventDefault();var t="id="+$(this).data("id")+"&action=ajaxDeleteNavigation",a=$(this).parent().parent().parent();wpieAjaxRequest(wpieAjax.ajaxUrl,"POST",t,function(e){a.remove()})}),$(document).on("click",".btn-modal",function(e){e.preventDefault(),$(".modal").removeClass("modal-active");var t=$(this).data("target");$(t).addClass("modal-active")}),$(document).on("click",".modal-close, .btn-modal-close",function(e){e.preventDefault(),e.stopPropagation(),$(".modal").removeClass("modal-active")}),$(document).on("click",".modal-content",function(e){e.stopPropagation()}),$(document).on("click",".modal",function(e){e.preventDefault(),$(this).removeClass("modal-active")}),$(document).on("click",".menu-item",function(e){isHomePage||(window.location.href=homeURL+"/"+$(this).attr("href"))}),$(document).on("click",".card",function(e){var t="pid="+$(this).data("pid")+"&action=ajaxVisitBookmark";wpieAjaxRequest(wpieAjax.ajaxUrl,"POST",t,function(e){console.log(e)})}),$(document).on("click",".card-love",function(e){e.preventDefault();var t=$(this).data("pid");if(!Cookies.get("love_"+t)){var a="pid="+t+"&action=ajaxLoveBookmark",n=$(this).find(".card-love-count"),i=$(this);wpieAjaxRequest(wpieAjax.ajaxUrl,"POST",a,function(e){i.addClass("active"),i.find(".czs-heart-l").removeClass("czs-heart-l").addClass("czs-heart"),n.html(e.extra)})}});var $noticeWrap=$(".notice-carousel-wrap");$noticeWrap.each(function(){var e=$(this).find(".notice-item").length,t=$(this);1<e&&setInterval(function(){t.stop(!0,!0).animate({top:"-44px"},200,function(){t.css("top","-2px"),t.append(t.find(".notice-item:first"))})},6e3)}),$(document).on("click",".fighting",function(){$("body, html").animate({scrollTop:0},600)}),$(window).scroll(function(){1e3<$(document).scrollTop()?$(".fighting").addClass("active"):$(".fighting").removeClass("active")}),window.onload=function(){$(window).trigger("scroll")},$(window).resize(function(){$(window).trigger("scroll")});var elements=Array.prototype.slice.call(document.querySelectorAll(".js-switch")),$btnBrief=document.getElementById("js-brief"),$btnDark=document.getElementById("js-dark");"true"===Cookies.get("brief")&&($btnBrief.checked="checked"),"true"===Cookies.get("dark")&&($btnDark.checked="checked",$("body").addClass("dark")),$btnBrief.onchange=function(){$btnBrief.checked?(Cookies.set("brief",!0),$(".card").addClass("card-brief")):(Cookies.set("brief",!1),$(".card").removeClass("card-brief"))},$btnDark.onchange=function(){$btnDark.checked?(Cookies.set("dark","true"),$("body").addClass("dark")):(Cookies.set("dark","false"),$("body").removeClass("dark"))},elements.forEach(function(e){new Switchery(e,{size:"small"})});},{}]},{},[1]);!function(a,b){"use strict";function c(){if(!e){e=!0;var a,c,d,f,g=-1!==navigator.appVersion.indexOf("MSIE 10"),h=!!navigator.userAgent.match(/Trident.*rv:11\./),i=b.querySelectorAll("iframe.wp-embedded-content");for(c=0;c<i.length;c++){if(d=i[c],!d.getAttribute("data-secret"))f=Math.random().toString(36).substr(2,10),d.src+="#?secret="+f,d.setAttribute("data-secret",f);if(g||h)a=d.cloneNode(!0),a.removeAttribute("security"),d.parentNode.replaceChild(a,d)}}}var d=!1,e=!1;if(b.querySelector)if(a.addEventListener)d=!0;if(a.wp=a.wp||{},!a.wp.receiveEmbedMessage)if(a.wp.receiveEmbedMessage=function(c){var d=c.data;if(d)if(d.secret||d.message||d.value)if(!/[^a-zA-Z0-9]/.test(d.secret)){var e,f,g,h,i,j=b.querySelectorAll('iframe[data-secret="'+d.secret+'"]'),k=b.querySelectorAll('blockquote[data-secret="'+d.secret+'"]');for(e=0;e<k.length;e++)k[e].style.display="none";for(e=0;e<j.length;e++)if(f=j[e],c.source===f.contentWindow){if(f.removeAttribute("style"),"height"===d.message){if(g=parseInt(d.value,10),g>1e3)g=1e3;else if(~~g<200)g=200;f.height=g}if("link"===d.message)if(h=b.createElement("a"),i=b.createElement("a"),h.href=f.getAttribute("src"),i.href=d.value,i.host===h.host)if(b.activeElement===f)a.top.location.href=d.value}else;}},d)a.addEventListener("message",a.wp.receiveEmbedMessage,!1),b.addEventListener("DOMContentLoaded",c,!1),a.addEventListener("load",c,!1)}(window,document);